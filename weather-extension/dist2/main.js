(()=>{const e={0:{emoji:"â˜€ï¸",desc:"ë§‘ìŒ",type:"clear"},1:{emoji:"ğŸŒ¤ï¸",desc:"ëŒ€ì²´ë¡œ ë§‘ìŒ",type:"clear"},2:{emoji:"â›…",desc:"ë¶€ë¶„ì ìœ¼ë¡œ íë¦¼",type:"cloudy"},3:{emoji:"â˜ï¸",desc:"íë¦¼",type:"cloudy"},45:{emoji:"ğŸŒ«ï¸",desc:"ì•ˆê°œ",type:"fog"},48:{emoji:"ğŸŒ«ï¸",desc:"ì§™ì€ ì•ˆê°œ",type:"fog"},51:{emoji:"ğŸŒ§ï¸",desc:"ê°€ë²¼ìš´ ì´ìŠ¬ë¹„",type:"rain"},53:{emoji:"ğŸŒ§ï¸",desc:"ì´ìŠ¬ë¹„",type:"rain"},55:{emoji:"ğŸŒ§ï¸",desc:"ê°•í•œ ì´ìŠ¬ë¹„",type:"rain"},61:{emoji:"ğŸŒ§ï¸",desc:"ì•½í•œ ë¹„",type:"rain"},63:{emoji:"ğŸŒ§ï¸",desc:"ë¹„",type:"rain"},65:{emoji:"ğŸŒ§ï¸",desc:"ê°•í•œ ë¹„",type:"rain"},71:{emoji:"â„ï¸",desc:"ì•½í•œ ëˆˆ",type:"snow"},73:{emoji:"â„ï¸",desc:"ëˆˆ",type:"snow"},75:{emoji:"â„ï¸",desc:"ê°•í•œ ëˆˆ",type:"snow"},77:{emoji:"ğŸŒ¨ï¸",desc:"ì§„ëˆˆê¹¨ë¹„",type:"snow"},80:{emoji:"ğŸŒ¦ï¸",desc:"ì•½í•œ ì†Œë‚˜ê¸°",type:"rain"},81:{emoji:"ğŸŒ¦ï¸",desc:"ì†Œë‚˜ê¸°",type:"rain"},82:{emoji:"â›ˆï¸",desc:"ê°•í•œ ì†Œë‚˜ê¸°",type:"rain"},85:{emoji:"ğŸŒ¨ï¸",desc:"ì•½í•œ ëˆˆë³´ë¼",type:"snow"},86:{emoji:"ğŸŒ¨ï¸",desc:"ëˆˆë³´ë¼",type:"snow"},95:{emoji:"â›ˆï¸",desc:"ì²œë‘¥ë²ˆê°œ",type:"rain"},96:{emoji:"â›ˆï¸",desc:"ìš°ë°•ì„ ë™ë°˜í•œ ì²œë‘¥",type:"rain"},99:{emoji:"â›ˆï¸",desc:"ê°•í•œ ìš°ë°•ì„ ë™ë°˜í•œ ì²œë‘¥",type:"rain"}},t=document.getElementById("weather-container"),n=(document.getElementById("weather-content"),document.getElementById("loading")),o=document.getElementById("weather-display"),a=document.getElementById("error-display"),d=document.getElementById("rain-container"),i=document.getElementById("snow-container");async function s(){try{n.classList.remove("hidden"),o.classList.add("hidden"),a.classList.add("hidden");const s=await new Promise((e,t)=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(t=>{e({latitude:t.coords.latitude,longitude:t.coords.longitude})},t=>{console.log("Using default location (Jeju)"),e({latitude:33.4996,longitude:126.5312})}):e({latitude:33.4996,longitude:126.5312})});!function(s,c){const r=s.current,m=s.hourly,l=e[r.weather_code]||e[0],y=(new Date).getHours(),u=y>=19||y<6;(function(n,o){const a=e[n]||e[0];t.className="",d.classList.remove("active"),i.classList.remove("active"),!o||"clear"!==a.type&&"cloudy"!==a.type?"clear"===a.type?t.classList.add("clear-day"):"rain"===a.type?(t.classList.add("rain"),function(){d.innerHTML="";for(let e=0;e<50;e++){const e=document.createElement("div");e.className="rain-drop",e.style.left=100*Math.random()+"%",e.style.animationDuration=.5*Math.random()+.5+"s",e.style.animationDelay=2*Math.random()+"s",d.appendChild(e)}}(),d.classList.add("active")):"snow"===a.type?(t.classList.add("snow"),function(){i.innerHTML="";for(let e=0;e<30;e++){const e=document.createElement("div");e.className="snowflake",e.textContent="â„",e.style.left=100*Math.random()+"%",e.style.animationDuration=3*Math.random()+3+"s",e.style.animationDelay=5*Math.random()+"s",e.style.fontSize=1*Math.random()+.5+"em",i.appendChild(e)}}(),i.classList.add("active")):"fog"===a.type?t.classList.add("fog"):t.classList.add("cloudy"):t.classList.add("clear-night")})(r.weather_code,u),document.getElementById("location").textContent=`ğŸ“ ${c}`,document.getElementById("weather-emoji").textContent=l.emoji,document.getElementById("temperature").textContent=`${Math.round(r.temperature_2m)}Â°C`,document.getElementById("weather-desc").textContent=l.desc,document.getElementById("wind-speed").textContent=`${Math.round(r.wind_speed_10m)} km/h`,document.getElementById("humidity").textContent=`${r.relative_humidity_2m}%`,document.getElementById("feels-like").textContent=`${Math.round(r.apparent_temperature)}Â°C`;const p=document.getElementById("hourly-list");p.innerHTML="";for(let t=0;t<6;t++){const n=new Date(m.time[t]).getHours(),o=Math.round(m.temperature_2m[t]),a=m.weather_code[t],d=e[a]||e[0],i=document.createElement("div");i.className="hourly-item",i.innerHTML=`\n      <div class="hourly-time">${n}ì‹œ</div>\n      <div class="hourly-emoji">${d.emoji}</div>\n      <div class="hourly-temp">${o}Â°C</div>\n    `,p.appendChild(i)}n.classList.add("hidden"),o.classList.remove("hidden"),a.classList.add("hidden")}(await async function(e,t){const n=`https://api.open-meteo.com/v1/forecast?latitude=${e}&longitude=${t}&current=temperature_2m,relative_humidity_2m,apparent_temperature,weather_code,wind_speed_10m&hourly=temperature_2m,weather_code&timezone=Asia/Seoul&forecast_days=1`,o=await fetch(n);if(!o.ok)throw new Error("ë‚ ì”¨ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");return await o.json()}(s.latitude,s.longitude),await async function(e,t){try{const n=await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${e}&lon=${t}&format=json&accept-language=ko`),o=(await n.json()).address;return o.city||o.town||o.village||o.county||"ìœ„ì¹˜ í™•ì¸ ì¤‘"}catch(e){return"ìœ„ì¹˜ í™•ì¸ ì¤‘"}}(s.latitude,s.longitude))}catch(e){console.error("Weather error:",e),s=e.message||"ë‚ ì”¨ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",document.getElementById("error-message").textContent=`âš ï¸ ${s}`,n.classList.add("hidden"),o.classList.add("hidden"),a.classList.remove("hidden")}var s}document.getElementById("refresh-btn").addEventListener("click",s),document.getElementById("retry-btn").addEventListener("click",s),s()})();